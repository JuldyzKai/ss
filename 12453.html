<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Қыз Жібек жыры - Интеллектуалды ойын</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            color: white;
            text-align: center;
            overflow-x: hidden;
            background-image: url('жж.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(103, 20, 20, 0);
            z-index: -1;
        }

        .container {
            width: 95%;
            max-width: 1400px;
            margin: 20px auto;
            padding: 20px;
            background-color: rgba(120, 180, 233, 0.395);
            border-radius: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.036);
            position: relative;
        }

        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(230, 213, 213, 0.075);
            color: #ffcc00;
        }

        h2 {
            font-size: 1.5rem;
            margin-top: 0;
            margin-bottom: 30px;
            text-shadow: 1px 1px 2px rgba(211, 159, 159, 0.341);
        }

        .wheels-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 50px;
            margin-bottom: 30px;
            position: relative;
        }

        .wheel-box {
            position: relative;
            width: 400px;
            height: 400px;
        }

        .wheel-title {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #ffcc00;
            font-weight: bold;
        }

        .wheel-container {
            position: relative;
            width: 100%;
            height: 100%;
            margin: 0 auto;
        }

        .wheel {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            border: 15px solid #333;
            box-shadow: 0 0 0 15px #444, 0 0 40px rgba(0, 0, 0, 0.8);
            transition: transform 2s cubic-bezier(0.17, 0.67, 0.12, 0.99);
            transform: rotate(0deg);
        }

        .wheel-item {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
            box-sizing: border-box;
            padding-left: 40px;
            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.5);
            color: #333;
        }

        .wheel-pointer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-left: 30px solid transparent;
            border-right: 30px solid transparent;
            border-top: 60px solid #ffcc00;
            z-index: 10;
            filter: drop-shadow(0 0 10px rgba(0, 0, 0, 0.7));
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .spin-btn {
            background: linear-gradient(to bottom, #ffcc00, #ff9900);
            border: none;
            color: #333;
            padding: 15px 50px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
            min-width: 250px;
        }

        .spin-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .spin-btn:active {
            transform: translateY(1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
        }

        .spin-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .question-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .question-content {
            background: linear-gradient(to bottom, #2c3e50, #1a2a6c);
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #ccc;
        }

        .question-header {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: #ffcc00;
        }

        .student-name {
            font-size: 2rem;
            color: #ff5555;
            font-weight: bold;
            margin-bottom: 20px;
            text-transform: uppercase;
        }

        .question-text {
            font-size: 1.8rem;
            margin-bottom: 30px;
            line-height: 1.5;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .media-container {
            margin: 20px 0;
            max-height: 300px;
            overflow: hidden;
            border-radius: 10px;
        }

        .media-container video, .media-container audio {
            max-width: 100%;
            border-radius: 10px;
        }

        .answer-controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
        }

        .answer-btn {
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 10px;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
        }

        .correct-btn {
            background: linear-gradient(to bottom, #4CAF50, #45a049);
            color: white;
        }

        .wrong-btn {
            background: linear-gradient(to bottom, #f44336, #d32f2f);
            color: white;
        }

        .answer-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .answer {
            font-size: 1.5rem;
            color: #ffcc00;
            font-weight: bold;
            margin-top: 20px;
            line-height: 1.5;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .correct {
            color: #4CAF50;
        }

        .incorrect {
            color: #f44336;
        }

        .timer {
            font-size: 1.8rem;
            color: #ff5555;
            font-weight: bold;
            margin: 20px 0;
        }

        .results-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(to bottom, #2196F3, #0b7dda);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 1.2rem;
            font-weight: bold;
            border-radius: 25px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 10;
        }

        .results-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            z-index: 200;
            justify-content: center;
            align-items: center;
        }

        .results-content {
            background: linear-gradient(to bottom, #2c3e50, #1a2a6c);
            padding: 30px;
            border-radius: 15px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            text-align: center;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5);
            position: relative;
        }

        .results-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .results-table th, .results-table td {
            padding: 12px;
            border-bottom: 1px solid #444;
        }

        .results-table th {
            background-color: #333;
            color: #ffcc00;
        }

        .results-table tr:nth-child(even) {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .game-over {
            font-size: 2.5rem;
            color: #ffcc00;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        @media (max-width: 1200px) {
            .wheel-box {
                width: 350px;
                height: 350px;
            }
        }

        @media (max-width: 900px) {
            .wheels-container {
                flex-direction: column;
                gap: 30px;
            }
            
            .wheel-box {
                width: 300px;
                height: 300px;
            }
            
            .question-text {
                font-size: 1.4rem;
            }
        }

        @media (max-width: 600px) {
            .wheel-box {
                width: 250px;
                height: 250px;
            }
            
            .question-text {
                font-size: 1.2rem;
            }
            
            .student-name {
                font-size: 1.5rem;
            }
            
            .answer-controls {
                flex-direction: column;
                gap: 10px;
            }
            
            .answer-btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <div class="container">
        <h1>Қыз Жібек жыры</h1>
        <h2>Интеллектуалды ойын</h2>
        
        <div class="wheels-container">
            <div class="wheel-box">
                <div class="wheel-title">Оқушылар</div>
                <div class="wheel-container">
                    <div class="wheel" id="studentsWheel"></div>
                </div>
            </div>
            
            <div class="wheel-box">
                <div class="wheel-title">Сұрақтар</div>
                <div class="wheel-container">
                    <div class="wheel" id="questionsWheel"></div>
                </div>
            </div>
            
            <div class="wheel-pointer"></div>
        </div>
        
        <div class="controls">
            <button class="spin-btn" id="spinBtn">СПИННЕРДІ АЙНАЛДЫРУ</button>
        </div>
    </div>
    
    <div class="question-modal" id="questionModal">
        <div class="question-content">
            <span class="close-btn" id="closeModal">&times;</span>
            <div class="question-header">Жауап беруге:</div>
            <div class="student-name" id="studentName"></div>
            <div class="question-text" id="questionText"></div>
            
            <div class="media-container" id="mediaContainer"></div>
            
            <div class="timer" id="timer">15 секунд қалды</div>
            <div class="answer" id="correctAnswer"></div>
            
            <div class="answer-controls">
                <button class="answer-btn correct-btn" id="correctBtn">ДҰРЫС ЖАУАП</button>
                <button class="answer-btn wrong-btn" id="wrongBtn">ҚАТЕ ЖАУАП</button>
            </div>
        </div>
    </div>
    
    <button class="results-btn" id="resultsBtn">НӘТИЖЕЛЕР</button>
    
    <div class="results-modal" id="resultsModal">
        <div class="results-content">
            <span class="close-btn" id="closeResults">&times;</span>
            <h2>Ойын нәтижелері</h2>
            <div id="gameStatus"></div>
            <table class="results-table">
                <thead>
                    <tr>
                        <th>Оқушы</th>
                        <th>Дұрыс жауаптар</th>
                        <th>Қате жауаптар</th>
                        <th>Ұпайлар</th>
                    </tr>
                </thead>
                <tbody id="resultsTable">
                </tbody>
            </table>
        </div>
    </div>
    
    <audio id="backgroundMusic" loop>
        <source src="Нұрғиса Тілендиев - Махамбет.mp3" type="audio/mpeg">
    </audio>
    <audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3"></audio>
    <audio id="winSound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="correctSound" src="https://assets.mixkit.co/sfx/preview/mixkit-correct-answer-tone-2870.mp3"></audio>
    <audio id="wrongSound" src="https://assets.mixkit.co/sfx/preview/mixkit-wrong-answer-fail-notification-946.mp3"></audio>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Ойын конфигурациясы
            const config = {
                students: [
                    "Ақжан Ахметов", "Бахыт Қалиев", "Гүлнар Сағатова", "Дамир Жұмашев", 
                    "Ерлан Нұрғалиев", "Жансая Өмірзақова", "Зере Қасенова", "Ильяс Баймуратов",
                    "Қадыр Жанғалиев", "Ләззат Әбілова", "Мәдина Төлегенова", "Нұрбол Сапарбаев",
                    "Оразғүл Исаева", "Перизат Құрманғалиева", "Рауан Досжанов", "Сандуғаш Тілеубердиева",
                    "Талғат Мұратбаев", "Ұлжан Қадырова", "Фарида Жантемирова", "Ханзада Еркінбаева",
                    "Шыңғыс Байбеков", "Әлия Сапарбекқызы", "Іңкәр Жақыпова", "Құралай Төлеубаева",
                    "Мейрамбек Қожанов"
                ],
                questions: [
                    {
                        question: "Қыз Жібек жыры қандай жыр түріне жатады?",
                        answer: "Ғашықтық (лиро-эпостық) жыр"
                    },
                    {
                        question: "Бұл жырдың басты тақырыбы қандай?",
                        answer: "Махаббат пен адалдық, ерлік пен опасыздық"
                    },
                    {
                        question: "Жыр алғаш рет қашан және қайда басылып шыққан?",
                        answer: "1900 жылы Қазан қаласында"
                    },
                    {
                        question: "Жырдағы оқиғалар қай кезеңнің тарихи шындығына негізделген?",
                        answer: "XVI–XVII ғасырлар"
                    },
                    {
                        question: "Жырда Төлеген кімнің баласы?",
                        answer: "Базарбайдың"
                    },
                    {
                        question: "Төлегеннің інісі кім?",
                        answer: "Сансызбай"
                    },
                    {
                        question: "Жырда Қыз Жібек кімнің қызы ретінде сипатталады?",
                        answer: "Сырлыбайдың қызы"
                    },
                    {
                        question: "Жырда Төлеген қай елдің қызын іздейді?",
                        answer: "Арғын, Найман, Керей елінен, кейін Жайық бойынан"
                    },
                    {
                        question: "Саудагер шал Төлегенге қандай елде сұлу қыз бар екенін айтады?",
                        answer: "Кіші жүз елінде, Жағалбайлы арасында"
                    },
                    {
                        question: "Қаршыға деген кім және оның рөлі қандай?",
                        answer: "Сырлыбайдың елінен шыққан сері жігіт, Төлегенді Жібекке жеткізуші жолсерік"
                    },
                    {
                        question: "Төлеген Жібекпен алғаш қай жерде кездеседі?",
                        answer: "Жібек көшпен келе жатқанда, күймеде отырған сәтінде"
                    },
                    {
                        question: "Жібек Төлегенге алғаш қалай жауап береді?",
                        answer: "Салмақпен, сынай сөйлейді, бастапқыда жақындауға рұқсат бермейді"
                    },
                    {
                        question: "Төлеген мен Жібек қай жерде оңаша сөйлеседі?",
                        answer: "Жібек келін болып түскен отауда"
                    },
                    {
                        question: "Төлеген неліктен еліне қайтады?",
                        answer: "Әкесінің батасын алу үшін"
                    },
                    {
                        question: "Төлеген еліне қайтарда Жібекке не уәде етеді?",
                        answer: "Бір жылдан кейін қайта оралатынын айтады"
                    },
                    {
                        question: "Бекежан қандай кейіпкер ретінде бейнеленеді?",
                        answer: "Қызғаншақ, опасыз, сатқын"
                    },
                    {
                        question: "Төлегенді кім өлтіреді және қалай?",
                        answer: "Бекежан өлтіреді — түнде қапыда жаралап, артынан басын кесіп алады"
                    },
                    {
                        question: "Жібек түсінде не көреді?",
                        answer: "Төлеген мінген көк жорға аты бос келе жатқанын, жаман ырым"
                    },
                    {
                        question: "Сансызбай кім және ол жырда қандай рөл атқарады?",
                        answer: "Төлегеннің інісі, кейін ағасының кегін алып, Жібекті құтқарады"
                    },
                    {
                        question: "Сансызбай ағасының жолын не үшін жалғастырады?",
                        answer: "Ағасының өлімі үшін кек алу және Жібекті қорғау"
                    },
                    {
                        question: "Қыз Жібек жырында қандай ұлттық салт-дәстүрлер көрініс табады?",
                        answer: "Қыз айттыру, көші-қон, батырлық, елшілік, бата, жоқтау"
                    },
                    {
                        question: "Жырдағы әйел бейнесі — Қыз Жібек қандай қасиеттермен суреттеледі?",
                        answer: "Ақылды, сұлу, сабырлы, шешен, ар-намысты"
                    },
                    {
                        question: "Базарбай баласының сапарға шығуына қалай қарайды?",
                        answer: "Қатты қарсы"
                    }
                ],
                colors: [
                    "#FF5733", "#33FF57", "#3357FF", "#F3FF33", "#FF33F3",
                    "#33FFF3", "#FF8C33", "#8C33FF", "#33FF8C", "#FF338C",
                    "#33A2FF", "#A2FF33", "#FF33A2", "#33FFA2", "#A233FF",
                    "#FFA233", "#33A2FF", "#A2FF33", "#FF33A2", "#33FFA2",
                    "#FF5733", "#33FF57", "#3357FF", "#F3FF33", "#FF33F3"
                ]
            };

            // DOM элементтері
            const studentsWheel = document.getElementById('studentsWheel');
            const questionsWheel = document.getElementById('questionsWheel');
            const spinBtn = document.getElementById('spinBtn');
            const questionModal = document.getElementById('questionModal');
            const studentName = document.getElementById('studentName');
            const questionText = document.getElementById('questionText');
            const mediaContainer = document.getElementById('mediaContainer');
            const correctAnswer = document.getElementById('correctAnswer');
            const timerElement = document.getElementById('timer');
            const closeModal = document.getElementById('closeModal');
            const correctBtn = document.getElementById('correctBtn');
            const wrongBtn = document.getElementById('wrongBtn');
            const resultsBtn = document.getElementById('resultsBtn');
            const resultsModal = document.getElementById('resultsModal');
            const resultsTable = document.getElementById('resultsTable');
            const closeResults = document.getElementById('closeResults');
            const gameStatus = document.getElementById('gameStatus');
            const backgroundMusic = document.getElementById('backgroundMusic');
            const spinSound = document.getElementById('spinSound');
            const winSound = document.getElementById('winSound');
            const correctSound = document.getElementById('correctSound');
            const wrongSound = document.getElementById('wrongSound');

            // Айнымалылар
            let isSpinning = false;
            let studentsSpinAngle = 0;
            let questionsSpinAngle = 0;
            let countdown;
            let timeLeft = 15;
            let selectedStudent = "";
            let selectedQuestion = {};
            let studentResults = {};
            let currentAttempt = { student: "", question: "", isCorrect: false };
            let activeStudents = [...config.students];
            let activeQuestions = [...config.questions];
            let isGameOver = false;

            // Бастапқы нәтижелерді инициализациялау
            function initResults() {
                config.students.forEach(student => {
                    studentResults[student] = {
                        correct: 0,
                        wrong: 0,
                        points: 0
                    };
                });
            }

            // Дөңгелектерді құру
            function createWheels() {
                studentsWheel.innerHTML = '';
                questionsWheel.innerHTML = '';
                
                // Оқушылар дөңгелегі
                const studentSegmentAngle = 360 / activeStudents.length;
                activeStudents.forEach((student, i) => {
                    const segment = document.createElement('div');
                    segment.className = 'wheel-item';
                    segment.style.transform = `rotate(${i * studentSegmentAngle}deg)`;
                    segment.style.backgroundColor = config.colors[i];
                    segment.style.clipPath = 'polygon(0 0, 100% 0, 100% 100%)';
                    
                    const text = document.createElement('div');
                    text.textContent = student.split(' ')[0]; // Тек есімін көрсету
                    text.style.transform = `rotate(${studentSegmentAngle / 2}deg) translateX(40px)`;
                    
                    segment.appendChild(text);
                    studentsWheel.appendChild(segment);
                });

                // Сұрақтар дөңгелегі
                const questionSegmentAngle = 360 / activeQuestions.length;
                activeQuestions.forEach((question, i) => {
                    const segment = document.createElement('div');
                    segment.className = 'wheel-item';
                    segment.style.transform = `rotate(${i * questionSegmentAngle}deg)`;
                    segment.style.backgroundColor = config.colors[i+5]; // Түстерді өзгерту
                    segment.style.clipPath = 'polygon(0 0, 100% 0, 100% 100%)';
                    
                    const text = document.createElement('div');
                    text.textContent = `Сұрақ ${i+1}`;
                    text.style.transform = `rotate(${questionSegmentAngle / 2}deg) translateX(40px)`;
                    
                    segment.appendChild(text);
                    questionsWheel.appendChild(segment);
                });
            }

            // Дөңгелектерді айналдыру
            function spinWheels() {
                if (isSpinning || isGameOver) return;
                
                if (activeStudents.length === 0 || activeQuestions.length === 0) {
                    endGame();
                    return;
                }
                
                isSpinning = true;
                spinBtn.disabled = true;
                
                // Дыбысты ойнату
                spinSound.currentTime = 0;
                spinSound.play();
                
                // Кездейсоқ бұрыштар (5 айналым + сегмент бұрышы)
                studentsSpinAngle += 1800 + Math.floor(Math.random() * 360);
                questionsSpinAngle += 1800 + Math.floor(Math.random() * 360);
                
                // Дөңгелектерді айналдыру
                studentsWheel.style.transform = `rotate(${studentsSpinAngle}deg)`;
                questionsWheel.style.transform = `rotate(${questionsSpinAngle}deg)`;
                
                // Айналу аяқталғаннан кейін
                setTimeout(() => {
                    isSpinning = false;
                    
                    // Жеңіс дыбысы
                    winSound.play();
                    
                    // Жеңілген оқушыны анықтау
                    const studentSegmentAngle = 360 / activeStudents.length;
                    const studentNormalizedAngle = studentsSpinAngle % 360;
                    const winningStudentSegment = Math.floor((360 - studentNormalizedAngle) / studentSegmentAngle);
                    selectedStudent = activeStudents[winningStudentSegment];
                    
                    // Жеңілген сұрақты анықтау
                    const questionSegmentAngle = 360 / activeQuestions.length;
                    const questionNormalizedAngle = questionsSpinAngle % 360;
                    const winningQuestionSegment = Math.floor((360 - questionNormalizedAngle) / questionSegmentAngle);
                    selectedQuestion = activeQuestions[winningQuestionSegment];
                    
                    // Сұрақты көрсету
                    showQuestion();
                }, 2000); // 2 секундтан соң тоқтату
            }

            // Сұрақты көрсету
            function showQuestion() {
                // Мәліметтерді толтыру
                studentName.textContent = selectedStudent;
                questionText.textContent = selectedQuestion.question;
                correctAnswer.textContent = `Дұрыс жауап: ${selectedQuestion.answer}`;
                correctAnswer.className = 'answer';
                correctAnswer.style.display = 'none';
                
                // Таймерді қалпына келтіру
                clearInterval(countdown);
                timeLeft = 15;
                updateTimer();
                
                // Модалды терезе көрсету
                questionModal.style.display = 'flex';
                
                // Таймерді бастау
                countdown = setInterval(() => {
                    timeLeft--;
                    updateTimer();
                    
                    if (timeLeft <= 0) {
                        clearInterval(countdown);
                        handleAnswer(false); // Уақыт аяқталса, автоматты түрде қате деп есептеу
                    }
                }, 1000);
            }

            // Жауапты өңдеу
            function handleAnswer(isCorrect) {
                clearInterval(countdown);
                
                // Нәтижені сақтау
                currentAttempt = {
                    student: selectedStudent,
                    question: selectedQuestion.question,
                    isCorrect: isCorrect
                };
                
                if (isCorrect) {
                    studentResults[selectedStudent].correct++;
                    studentResults[selectedStudent].points += 10;
                    correctSound.play();
                    correctAnswer.classList.add('correct');
                } else {
                    studentResults[selectedStudent].wrong++;
                    wrongSound.play();
                    correctAnswer.classList.add('incorrect');
                }
                
                correctAnswer.style.display = 'block';
                
                // Жауап берген оқушыны және сұрақты жою
                activeStudents = activeStudents.filter(student => student !== selectedStudent);
                activeQuestions = activeQuestions.filter(question => question.question !== selectedQuestion.question);
                
                // 3 секундтан соң келесі айналдыруды бастау
                setTimeout(() => {
                    closeQuestionModal();
                    spinBtn.disabled = false;
                    spinWheels(); // Дұрыс немесе қате жауаптан кейін айналдыруды жалғастыру
                }, 3000);
            }

            // Ойынды аяқтау
            function endGame() {
                isGameOver = true;
                spinBtn.disabled = true;
                showResults();
                
                // Ойын аяқталды хабарламасы
                const gameOverMessage = document.createElement('div');
                gameOverMessage.className = 'game-over';
                gameOverMessage.textContent = 'ОЙЫН АЯҚТАЛДЫ!';
                gameStatus.appendChild(gameOverMessage);
            }

            // Таймерді жаңарту
            function updateTimer() {
                timerElement.textContent = `${timeLeft} секунд қалды`;
                
                // Уақыт азайған сайын түсін өзгерту
                if (timeLeft <= 5) {
                    timerElement.style.color = '#ff0000';
                    timerElement.style.animation = 'pulse 0.5s infinite';
                } else {
                    timerElement.style.color = '#ff5555';
                    timerElement.style.animation = 'none';
                }
            }

            // Модалды терезені жабу
            function closeQuestionModal() {
                questionModal.style.display = 'none';
                clearInterval(countdown);
            }

            // Нәтижелерді көрсету
            function showResults() {
                resultsTable.innerHTML = '';
                gameStatus.innerHTML = '';
                
                if (isGameOver) {
                    const gameOverMessage = document.createElement('div');
                    gameOverMessage.className = 'game-over';
                    gameOverMessage.textContent = 'ОЙЫН АЯҚТАЛДЫ!';
                    gameStatus.appendChild(gameOverMessage);
                }
                
                // Әр оқушы үшін жол қосу
                config.students.forEach(student => {
                    const row = document.createElement('tr');
                    
                    const nameCell = document.createElement('td');
                    nameCell.textContent = student;
                    row.appendChild(nameCell);
                    
                    const correctCell = document.createElement('td');
                    correctCell.textContent = studentResults[student].correct;
                    row.appendChild(correctCell);
                    
                    const wrongCell = document.createElement('td');
                    wrongCell.textContent = studentResults[student].wrong;
                    row.appendChild(wrongCell);
                    
                    const pointsCell = document.createElement('td');
                    pointsCell.textContent = studentResults[student].points;
                    row.appendChild(pointsCell);
                    
                    resultsTable.appendChild(row);
                });
                
                resultsModal.style.display = 'flex';
            }

            // Оқиғаларды байланыстыру
            spinBtn.addEventListener('click', spinWheels);
            correctBtn.addEventListener('click', () => handleAnswer(true));
            wrongBtn.addEventListener('click', () => handleAnswer(false));
            closeModal.addEventListener('click', closeQuestionModal);
            questionModal.addEventListener('click', (e) => {
                if (e.target === questionModal) {
                    closeQuestionModal();
                }
            });
            resultsBtn.addEventListener('click', showResults);
            closeResults.addEventListener('click', () => {
                resultsModal.style.display = 'none';
            });
            resultsModal.addEventListener('click', (e) => {
                if (e.target === resultsModal) {
                    resultsModal.style.display = 'none';
                }
            });

            // Бастапқы инициализация
            initResults();
            createWheels();
            
            // Фондық музыканы бастау
            document.addEventListener('click', function initAudio() {
                backgroundMusic.volume = 0.1;
                backgroundMusic.play().then(() => {
                    console.log("Музыка успешно запущена после взаимодействия");
                }).catch(e => {
                    console.log("Ошибка воспроизведения:", e);
                });
                document.removeEventListener('click', initAudio);
            }, { once: true });
        });
    </script>
</body>
</html>